import os
import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer

def features():
    path = 'dataset'

    labels = []
    text = []

    for filename in os.listdir(path):
        if "Good" in filename:
            labels.append("1")
        else:
            labels.append("-1")
        filename = os.path.join(path, filename)
        print(filename)
        with open(filename) as f:
            content = f.read()
            content.replace(",", "")
            content.replace('"', "")
            text.append(content)

    vectorizer = CountVectorizer(stop_words='english', max_features=5000)

    dtm = vectorizer.fit_transform(text)
    df = pd.DataFrame(dtm.toarray(), index=labels, \
                      columns=vectorizer.get_feature_names())

    df.index.name = "labels"
    df.to_csv(r'C:\Users\Aamir\PycharmProjects\dataset\dynamic_api_call_sequence_per_malware_100_0_306.csv')

    features_list = vectorizer.get_feature_names()
    for feature in features_list:
        print(str(feature))

    print('<<<<<<<<<<<<<Done>>>>>>>>>>>>>')

def arbiting():
        features()
